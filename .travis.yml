# Set Ruby as the language so it doesn't download the pip things. Instead, let docker do that.
language: ruby
cache: bundler
install:
  - docker-compose -f travis-docker-compose.yml build
  - docker-compose -f travis-docker-compose.yml run watch npm install --quiet

script:
  - CI_ENV=`bash <(curl -s https://codecov.io/env)`
  - docker-compose -f travis-docker-compose.yml run web tox
  - docker-compose -f travis-docker-compose.yml run watch npm run-script codecov
  - docker-compose -f travis-docker-compose.yml run watch npm run-script lint
  - docker-compose -f travis-docker-compose.yml run watch npm run-script scss_lint
  - docker-compose -f travis-docker-compose.yml run watch npm run-script flow
  - docker-compose -f travis-docker-compose.yml run watch ./webpack_if_prod.sh
services:
  - docker
